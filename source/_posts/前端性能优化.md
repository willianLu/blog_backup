---
title: 前端性能优化
date: 2021-02-28 16:00
comments: true
---

>前端性能优化是指用户从开始访问网站开始到整个页面完整的展示出来的过程中，我们可以通过各种的优化策略和优化方法来加快页面的加载，让用户的操作响应更加及时，从而增强系统的用户使用感。
<!-- more -->

#### 1.图片资源加载优化
- 对图片进行压缩。
- 延迟加载图片，在真实的图片加载出来之前，可以使用一张公共的图片，把页面的整个布局撑起来，然后再换成真实的图片。
- 合理使用雪碧图，合并图片，减少请求量。
- 通过打包工具，使小图片转化成base64编码。

#### 2.HTML优化
- 减少标签嵌套，可以减少DOM树的节点数，让浏览器渲染最少的DOM节点数。
- 利用打包工具删除无意义的代码，如空格、注释等
- css文件链接放在页面头部，css加载不会阻塞DOM Tree解析，但是会阻塞DOM Tree的渲染，也会阻塞后面js的执行，所以在DOM Tree在渲染之前解析css，可以减少浏览器重排（[重排与重绘](http://mengyujing.com/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E9%87%8D%E7%BB%98%E4%B8%8E%E9%87%8D%E6%8E%92/)）的次数 ，而且css放在底部会导致页面白屏的时间变长。
- js文件一般放在页面的底部，这是为了防止js的加载和解析阻塞页面元素的正常渲染。

#### 3.用户体验
- 增加首屏必要的css和js。一般页面需要在等待所有的依赖加载完成之后才会展示，这样就会导致页面存在空白，可以增加背景图或者loading或者骨架屏。

#### 4.css优化细则
- 查找并删除未使用的css，显然会加快网页的加载速度。
- 使用简写，如margin-top/right/bottom/left => margin: 0 auto，可以从根本上减少css文件的大小。
- 尽量减少样式层级，，如div ul li span i{color:red}，可以给标签设置class来书写样式。
- 删除不必要的0和单位，如width:0.1em => width: .1em，margin: 0px auto => margin: 0 auto。
- 合理使用css选择器，尽量避免使用通配符，避免使用css表达式。
- 尽量少使用开销比较大的属性，如 border-radius box-shadow transform transitions filter :nth-child position: fixed。
- 使用打包工具对css文件进行（注释、空格等删除）压缩。
- 对css文件缓存，使用打包工具动态生成hash名称。
#### 5.js优化
- 慎用全局变量。全局变量定义在全局执行上下文，是所有作用域链的顶端。每次查找的时候都从局部找到最顶端，时间会有所消耗。全局执行上下文一直存在于上下文执行栈，直到程序退出，内存空间浪费。 如果某个局部作用域出现了同名变量则会遮蔽或污染全局。
- 缓存全局变量，将使用中无法避免的全局变量缓存到局部。
- 避开闭包陷阱，闭包可以在外部作用域访问函数内部作用域的数据。闭包使用不当很容易出现内存泄露，不要为了闭包而闭包。
- 通过原型新增方法，而不是在构造函数内部添加方法。
- 节点操作优化，减少频繁操作DOM，使用虚拟节点createdocumentfragment或克隆节点cloneNode等方式。
- 尽量避免js动画，使用css3动画代替。
#### 6.其他优化
- 为了减少回流发生次数，避免频繁的操作DOM，可以合并多次对DOM统一修改，一次性批量处理。
- 可以使用绝对定位让动画元素脱离文档流。
- 懒加载，预加载，预渲染。
>懒加载指长页面中延迟加载特定的元素，从而减少当前屏无效资源的加载。
>预加载是让浏览器预先加载某些资源。
>预渲染是进行资源的提前渲染。
- 多个接口时，可以合并接口，减少页面接口请求。